## 第五章 IP协议相关技术

### DNS

**DNS的产生**

TCP/IP有一个叫做主机识别码的东西。这种识别方式是指每台计算机赋以唯一的主机名，在进行网络通信时可以直接使用主机名称而无需输入一大长串的IP地址。为了实现这样的功能，主机往往会利用一个叫做hosts的数据库文件。

互联网的初期，由互联网信息中心整体管理一份hosts文件，但随着映射增多，更新和维护都很麻烦。在此背景下，产生了一个可以有效管理主机名和IP地址之间对应关系的系统，那就是DNS。

在应用中，当用户输入主机名（域名）时，DNS会自动检索那个注册了主机名和IP地址的数据库，并迅速定位对应的IP地址。而且，如果主机名和IP地址需要进行变更时，也只需要在组织机构内部进行处理即可，而没必要再向其他机构进行申请或报告。

**域名的构成**

域名是指为了识别主机名称和组织机构名称的一种具体分层名称。例如：

```
kusa.ac.jp
```

进行DNS查询的主机和软件叫做DNS解析器。用户所使用的工作站或个人电脑都属于解析器。

根域名服务器：

根服务器主要用来管理[互联网](https://baike.baidu.com/item/%E4%BA%92%E8%81%94%E7%BD%91/199186)的主目录，全世界IPv4根服务器只有13台（这13台IPv4根域名服务器名字分别为“A”至“M”），1个为主根服务器在[美国](https://baike.baidu.com/item/%E7%BE%8E%E5%9B%BD/125486)。其余12个均为辅根服务器，其中9个在美国，[欧洲](https://baike.baidu.com/item/%E6%AC%A7%E6%B4%B2/145550)2个，位于[英国](https://baike.baidu.com/item/%E8%8B%B1%E5%9B%BD/144602)和[瑞典](https://baike.baidu.com/item/%E7%91%9E%E5%85%B8/291092)，亚洲1个位于[日本](https://baike.baidu.com/item/%E6%97%A5%E6%9C%AC/111617)。

**DNS查询**

<div>
    <image src="../res/img/dns1.png"></image>
</div>
解析器为了查询IP，向域名服务器进行查询处理。接收这个查询请求的域名服务器首先会在自己的数据库进行查找。如果没有，则域名服务器再向上一层根域名服务器进行查询处理。

### ARP

ARP是一种解决地址问题的协议。以目标地址为线索，用来定位下一个应该接收数据分包的网络设备对应的MAC地址。

工作原理：主机A为了获得主机B的MAC地址，起初要通过广播发送一个ARP请求包。这个包中包含了想要了解其MAC地址的主机IP地址。由于广播的包可以被同一个链路上所有的主机或路由器接收，因此ARP的请求包也就会被这同一链路上所有的主机和路由器解析。如果ARP请求包中的目标IP地址和自己的IP地址一致，那么这个节点就将自己的MAC地址塞入ARP响应包返回给主机A。

### DHCP

如果逐一为每一台主机设置IP地址会非常繁琐。于是，为了实现自动设置IP地址、统一管理IP地址分配，就产生了DHCP协议。

工作原理：使用DHCP之前，首先要架设一台DHCP服务器。然后将DHCP所要分配的IP地址设置到服务器上。此外，还需要将相应的子网掩码、路由控制信息以及DNS服务器的地址等设置到服务器上。